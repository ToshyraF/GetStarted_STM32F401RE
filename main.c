/**
  ******************************************************************************
  * @file    main.c
  * @author  Ac6
  * @version V1.0
  * @date    01-December-2013
  * @brief   Default main function.
  ******************************************************************************
*/

#define SAMPLES                    256             /* 256 real party and 256 imaginary parts */
#define FFT_SIZE                SAMPLES / 2        /* FFT size is always the same size as we have samples, so 256 in our case */
#define ARM_MATH_CM4
#include "stm32f4xx.h"
#include "stm32f4xx_nucleo.h"

#include "arm_math.h"
#include <stdio.h>
#include <stdlib.h>

float32_t Input[SAMPLES]={
		0.000000000000000000e+00,
		3.841057419776916504e-01,
		7.092812657356262207e-01,
		9.256376624107360840e-01,
		9.999810457229614258e-01,
		9.209055304527282715e-01,
		7.005431056022644043e-01,
		3.727019429206848145e-01,
		-1.231957878917455673e-02,
		-3.954512476921081543e-01,
		-7.179118394851684570e-01,
		-9.302293062210083008e-01,
		-9.998292326927185059e-01,
		-9.160335063934326172e-01,
		-6.916983723640441895e-01,
		-3.612416982650756836e-01,
		2.463728748261928558e-02,
		4.067368209362030029e-01,
		7.264336347579956055e-01,
		9.346797466278076172e-01,
		9.995257258415222168e-01,
		9.110227823257446289e-01,
		6.827488541603088379e-01,
		3.497261703014373779e-01,
		-3.695125877857208252e-02,
		-4.179604351520538330e-01,
		-7.348452806472778320e-01,
		-9.389883279800415039e-01,
		-9.990704655647277832e-01,
		-9.058735966682434082e-01,
		-6.736956834793090820e-01,
		-3.381580114364624023e-01,
		4.925961792469024658e-02,
		4.291206300258636475e-01,
		7.431450486183166504e-01,
		9.431543350219726562e-01,
		9.984635710716247559e-01,
		9.005864858627319336e-01,
		6.645402908325195312e-01,
		3.265385329723358154e-01,
		-6.156050413846969604e-02,
		-4.402165412902832031e-01,
		-7.513314485549926758e-01,
		-9.471772313117980957e-01,
		-9.977051615715026855e-01,
		-8.951631188392639160e-01,
		-6.552832722663879395e-01,
		-3.148703873157501221e-01,
		7.385204732418060303e-02,
		4.512439370155334473e-01,
		7.594050765037536621e-01,
		9.510567188262939453e-01,
		9.967952370643615723e-01,
		8.896043300628662109e-01,
		6.459283232688903809e-01,
		3.031526207923889160e-01,
		-8.613333106040954590e-02,
		-4.622045457363128662e-01,
		-7.673621773719787598e-01,
		-9.547911882400512695e-01,
		-9.957342147827148438e-01,
		-8.839095830917358398e-01,
		-6.364737749099731445e-01,
		-2.913888692855834961e-01,
		9.839963912963867188e-02,
		4.730933010578155518e-01,
		7.752040028572082520e-01,
		9.583813548088073730e-01,
		9.945217967033386230e-01,
		8.780816197395324707e-01,
		6.269241571426391602e-01,
		2.795827090740203857e-01,
		-1.106529086828231812e-01,
		-4.839119315147399902e-01,
		-7.829281687736511230e-01,
		-9.618254899978637695e-01,
		-9.931586980819702148e-01,
		-8.721194863319396973e-01,
		-6.172779202461242676e-01,
		-2.677322626113891602e-01,
		1.228874921798706055e-01,
		4.946554601192474365e-01,
		7.905335426330566406e-01,
		9.651241302490234375e-01,
		9.916448593139648438e-01,
		8.660249114036560059e-01,
		6.075394153594970703e-01,
		2.558411955833435059e-01,
		-1.351053118705749512e-01,
		-5.053238868713378906e-01,
		-7.980176806449890137e-01,
		-9.682758450508117676e-01,
		-9.899799823760986328e-01,
		-8.597999215126037598e-01,
		-5.977087616920471191e-01,
		-2.439131438732147217e-01,
		1.473007351160049438e-01,
		5.159189105033874512e-01,
		8.053807616233825684e-01,
		9.712805747985839844e-01,
		9.881653785705566406e-01,
		8.534443974494934082e-01,
		5.877843499183654785e-01,
		2.319480627775192261e-01,
		-1.594775766134262085e-01,
		-5.264323949813842773e-01,
		-8.126215934753417969e-01,
		-9.741387963294982910e-01,
		-9.862008690834045410e-01,
		-8.469573259353637695e-01,
		-5.777737498283386230e-01,
		-2.199478000402450562e-01,
		1.716264486312866211e-01,
		5.368659496307373047e-01,
		8.197413086891174316e-01,
		9.768483042716979980e-01,
		9.840866327285766602e-01,
		8.403437137603759766e-01,
		5.676754713058471680e-01,
		2.079104185104370117e-01,
		-1.837492734193801880e-01,
		-5.472180247306823730e-01,
		-8.267344236373901367e-01,
		-9.794095158576965332e-01,
		-9.818223714828491211e-01,
		-8.336026072502136230e-01,
		-5.574879050254821777e-01,
		-1.958452016115188599e-01,
		1.958442032337188721e-01,
		5.574902296066284180e-01,
		8.336020708084106445e-01,
		9.818229079246520996e-01,
		9.794097542762756348e-01,
		8.267350196838378906e-01,
		5.472188591957092285e-01,
		1.837502717971801758e-01,
		-2.079131454229354858e-01,
		-5.676746368408203125e-01,
		-8.403431773185729980e-01,
		-9.840864539146423340e-01,
		-9.768485426902770996e-01,
		-8.197396993637084961e-01,
		-5.368667840957641602e-01,
		-1.716274470090866089e-01,
		2.199468016624450684e-01,
		5.777729153633117676e-01,
		8.469588160514831543e-01,
		9.862006902694702148e-01,
		9.741382002830505371e-01,
		8.126221895217895508e-01,
		5.264332294464111328e-01,
		1.594748198986053467e-01,
		-2.319470793008804321e-01,
		-5.877866148948669434e-01,
		-8.534438610076904297e-01,
		-9.881652593612670898e-01,
		-9.712808132171630859e-01,
		-8.053813576698303223e-01,
		-5.159165263175964355e-01,
		-1.473017483949661255e-01,
		2.439121603965759277e-01,
		5.977079868316650391e-01,
		8.597993850708007812e-01,
		9.899803996086120605e-01,
		9.682751297950744629e-01,
		7.980182766914367676e-01,
		5.053247809410095215e-01,
		1.351025402545928955e-01,
		-2.558402121067047119e-01,
		-6.075386404991149902e-01,
		-8.660263419151306152e-01,
		-9.916442632675170898e-01,
		-9.651244282722473145e-01,
		-7.905318140983581543e-01,
		-4.946530163288116455e-01,
		-1.228903904557228088e-01,
		2.677331268787384033e-01,
		6.172801256179809570e-01,
		8.721180558204650879e-01,
		9.931585788726806641e-01,
		9.618252515792846680e-01,
		7.829252481460571289e-01,
		4.839128255844116211e-01,
		1.106520220637321472e-01,
		-2.795853912830352783e-01,
		-6.269218921661376953e-01,
		-8.780811429023742676e-01,
		-9.945220947265625000e-01,
		-9.583821892738342285e-01,
		-7.752046585083007812e-01,
		-4.730924963951110840e-01,
		-9.839685261249542236e-02,
		2.913878858089447021e-01,
		6.364744901657104492e-01,
		8.839108943939208984e-01,
		9.957339167594909668e-01,
		9.547914862632751465e-01,
		7.673615813255310059e-01,
		4.622071385383605957e-01,
		8.613434433937072754e-02,
		-3.031534850597381592e-01,
		-6.459304094314575195e-01,
		-8.896029591560363770e-01,
		-9.967952966690063477e-01,
		-9.510558247566223145e-01,
		-7.594069838523864746e-01,
		-4.512448310852050781e-01,
		-7.385116070508956909e-02,
		3.148730397224426270e-01,
		6.552825570106506348e-01,
		8.951635360717773438e-01,
		9.977053403854370117e-01,
		9.471781849861145020e-01,
		7.513321042060852051e-01,
		4.402140378952026367e-01,
		6.156437471508979797e-02,
		-3.265375494956970215e-01,
		-6.645409464836120605e-01,
		-9.005881547927856445e-01,
		-9.984635114669799805e-01,
		-9.431543946266174316e-01,
		-7.431432008743286133e-01,
		-4.291232824325561523e-01,
		-4.926063492894172668e-02,
		3.381597399711608887e-01,
		6.736928224563598633e-01,
		9.058727622032165527e-01,
		9.990705251693725586e-01,
		9.389873743057250977e-01,
		7.348465919494628906e-01,
		4.179604947566986084e-01,
		3.694941475987434387e-02,
		-3.497234284877777100e-01,
		-6.827480792999267578e-01,
		-9.110231399536132812e-01,
		-9.995258450508117676e-01,
		-9.346804618835449219e-01,
		-7.264333367347717285e-01,
		-4.067342579364776611e-01,
		-2.464021183550357819e-02,
		3.612411916255950928e-01,
		6.916996836662292480e-01,
		9.160321354866027832e-01,
		9.998292326927185059e-01,
		9.302290081977844238e-01,
		7.179097533226013184e-01,
		3.954532742500305176e-01,
		1.231964211910963058e-02,
		-3.727040886878967285e-01,
		-7.005408406257629395e-01,
		-9.209051728248596191e-01,
		-9.999810457229614258e-01,
		-9.256362915039062500e-01,
		-7.092825174331665039e-01,
		-3.841052353382110596e-01,
		2.797528850351227447e-06
};

float32_t Output[FFT_SIZE];

int main(void)
{
	arm_cfft_radix2_instance_f32 S;
	float32_t maxValue;
	uint32_t maxIndex;

	arm_cfft_radix2_init_f32(&S, FFT_SIZE, 0, 1);

	arm_cfft_radix2_f32(&S, Input);

	arm_cmplx_mag_f32(Input, Output, FFT_SIZE);

	arm_max_f32(Output, FFT_SIZE, &maxValue, &maxIndex);

//	for(;;);
}
